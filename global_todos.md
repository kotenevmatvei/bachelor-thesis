- [ ] refactor - modularize
- [ ] build tests - find the bug in histograms for t > 0.5s 